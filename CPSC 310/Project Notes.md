# Project Notes

## Refactoring Add Dataset
- Persistent Files:
	- `dataset_index.json`
		- the metadata file has an underscore to prevent collisions with possible dataset IDs
		- contains array of InsightDatasets that have been successfully added
	- `<dataset ID>.json`
- InsightFacade addDataset will attempt to construct an instance of InsightDataset
	- if no errors are caught, then we return `DiskUtil.retrieveAllDatasetIds`
- InsightDataset Class:
	- implements InsightDataset Interface
	- public fields:
		- id
		- kind
		- numRows
	- private fields:
		- \_data?: InsightData\[ \]
			- array of InsightData objects
				- InsightData is an interface
					- Implemented by SectionData and RoomData
					- typescript cannot enforce all elements of the array being of the same child type
						- i.e. we cannot have a sections dataset that contains roomData
						- thus, when adding dataset, we use the "kind" parameter to ensure all data follows the correct schema
	- `constructor(id, kind, numRows=0)`
		- validate ID
			- should invalidate:
				- contains underscore, whitespace only, empty, already exists
			- valid
				- characters only, characters and whitespace, numbers only
		- this.id = id
		- this.kind = kind
		- this.numRows == numRows
	- `getData(content?: string)`
		- if this.numRows == 0
			- if content == null
				- throw new InsightError("Cannot add dataset with no valid sections")
			- processRawContent()
		- if this.numRows > 0
			- if (data == null)
				- try DiskUtil.retrieveDataset(id)
			- else
				- return data
		- if data is null, use `DiskUtil.retrieveDataset(id)`
		- otherwise return data
	- public function `writeToDisk`
		- append `this.toListEntry()` to `dataset_index.json`
		- write data (with header) to `<id>.json`
			- id
			- kind
			- numRows
			- data
		- we store redundant copies of the metadata
			- maintaining `dataset_index.json` is simpler and more efficient than constructing a list by parsing each file and extracting the metadata from the header
	- private function `toListEntry`
		- returns an object to be used as an entry for `dataset_index.json`
- Retrieve Dataset takes a dataset ID and attempts to read it from disk. it returns a Dataset object
- [ ] make DIskUtil async!!!
- [ ] is it possible to have filenames that include `/`?